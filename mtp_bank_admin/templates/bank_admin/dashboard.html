{% extends 'base.html' %}
{% load i18n dates %}

{% block content %}
  {% get_preceding_weekdays 5 offset=1 as preceding_days %}
  <h1>{% trans 'Download files' %}</h1>

  {% include "includes/message_box.html" %}

  <div class="help-box help-box-popup help-box-hidden">
    <h3><div></div>{% trans 'Help with downloads' %}</h3>
    <div class="help-box-contents">
      <ul>
        <li>
          {% blocktrans trimmed %}
            The file will download automatically when you click 'Download file'. Check your downloads folder for it.
          {% endblocktrans %}
        </li>
      </ul>
    </div>
  </div>

  {% if perms.transaction.view_bank_details_transaction %}
  <section class="ContentBlock">
    <h3>{% trans 'Access Pay file – refunds' %}</h3>
    <a href="{% url 'bank_admin:download_refund_file' %}">
      {% now 'd/m/Y' as today %}
      {% blocktrans with date=today %}Download file for {{ date }}{% endblocktrans %}
    </a>
    <div class="help-box help-box-popup help-box-hidden">
      <h3><div></div>{% trans 'Previous file' %}</h3>
      <div class="help-box-contents">
        <ul>
          <li><a href="{% url 'bank_admin:download_previous_refund_file' %}">
            {% trans 'Download previous file' %}
          </a></li>
        </ul>
      </div>
    </div>
  </section>
  <hr/>
  {% endif %}

  <section class="ContentBlock">
    <h3>{% trans 'ADI Journal – refunds' %}</h3>
    <ul>
      {% for day in preceding_days %}
      <li>
        {% blocktrans with date=day|date:'d/m/Y' %}Transactions for {{ date }}{% endblocktrans %} |
        <a href="{% url 'bank_admin:download_adi_refund_file' %}?receipt_date={{ day|date:'Y-m-d' }}">
          {% trans 'Download file' %}
        </a>
      </li>
      {% endfor %}
    </ul>
    <hr/>
  </section>

  <section class="ContentBlock">
    <h3>{% trans 'ADI Journal – credits' %}</h3>
    <ul>
      {% for day in preceding_days %}
      <li>
        {% blocktrans with date=day|date:'d/m/Y' %}Transactions for {{ date }}{% endblocktrans %} |
        <a href="{% url 'bank_admin:download_adi_payment_file' %}?receipt_date={{ day|date:'Y-m-d' }}">
          {% trans 'Download file' %}
        </a>
      </li>
      {% endfor %}
    </ul>
    <hr/>
  </section>

  <section class="ContentBlock">
    <h3>{% trans 'Bank statement' %}</h3>
    <ul>
      {% for day in preceding_days %}
      <li>
        {% blocktrans with date=day|date:'d/m/Y' %}Transactions for {{ date }}{% endblocktrans %} |
        <a href="{% url 'bank_admin:download_bank_statement' %}?receipt_date={{ day|date:'Y-m-d' }}">
          {% trans 'Download file' %}
        </a>
      </li>
      {% endfor %}
    </ul>
    <hr/>
  </section>

{% endblock %}
